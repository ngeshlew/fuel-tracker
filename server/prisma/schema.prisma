// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model FuelTopup {
  id            String   @id @default(cuid())
  vehicleId     String   @map("vehicle_id")
  litres        Decimal
  costPerLitre  Decimal  @map("cost_per_litre")
  totalCost     Decimal  @map("total_cost")
  mileage       Decimal?
  date          DateTime
  type          TopupType
  fuelType      FuelType? @map("fuel_type")
  notes         String?
  isFirstTopup  Boolean  @default(false) @map("is_first_topup")
  createdAt     DateTime @default(now()) @map("created_at")
  updatedAt     DateTime @updatedAt @map("updated_at")

  @@map("fuel_topups")
}

model EnergyStatement {
  id            String   @id @default(cuid())
  supplier      String
  periodStart   DateTime @map("period_start")
  periodEnd     DateTime @map("period_end")
  totalKwh      Decimal  @map("total_kwh")
  totalCost     Decimal  @map("total_cost")
  unitRate      Decimal  @map("unit_rate")
  standingCharge Decimal @map("standing_charge")
  fileUrl       String?  @map("file_url")
  importedAt    DateTime @default(now()) @map("imported_at")

  @@map("energy_statements")
}

model ConsumptionAnalytics {
  id                String      @id @default(cuid())
  periodType        PeriodType  @map("period_type")
  periodDate        DateTime    @map("period_date")
  litres            Decimal     // Changed from kwh
  cost              Decimal
  averageDailyUsage Decimal?    @map("average_daily_usage")
  averageEfficiency Decimal?    @map("average_efficiency") // Miles per litre
  trend             TrendType?
  createdAt         DateTime    @default(now()) @map("created_at")

  @@map("consumption_analytics")
}

model UserPreferences {
  id             String   @id @default(cuid())
  userId         String   @map("user_id")
  theme          String   @default("dark")
  currency       String   @default("GBP")
  defaultFuelType FuelType? @map("default_fuel_type")
  trackMileage   Boolean  @default(false) @map("track_mileage")
  notifications  Boolean  @default(true)
  createdAt      DateTime @default(now()) @map("created_at")
  updatedAt      DateTime @updatedAt @map("updated_at")

  @@map("user_preferences")
}

enum TopupType {
  MANUAL
  IMPORTED
  ESTIMATED
}

enum FuelType {
  PETROL
  DIESEL
  ELECTRIC
  HYBRID
}

enum PeriodType {
  DAILY
  WEEKLY
  MONTHLY
}

enum TrendType {
  INCREASING
  DECREASING
  STABLE
}